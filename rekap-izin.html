<!DOCTYPE html>
<html lang="id">
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" href="style.css">

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script src="firebase-config.js"></script>

<title>Rekap Izin</title>
</head>
<body>

<div class="app">
    <h2>Rekap Izin / Ketidakhadiran</h2>

    <div class="card">
        <table>
            <thead>
                <tr>
                    <th>Nama</th>
                    <th>Keterangan</th>
                    <th>Alasan</th>
                    <th>Waktu</th>
                </tr>
            </thead>
            <tbody id="data"></tbody>
        </table>
    </div>

    <a class="back" href="izin.html">‚Üê Kembali</a>
</div>

<script>
function load(){
    let body = document.getElementById("data");
    body.innerHTML = "<tr><td colspan='4'>Memuat...</td></tr>";

    db.ref("izin").orderByChild("iso").on("value", snap => {
        let data = snap.val();
        body.innerHTML="";

        if(!data){
            body.innerHTML = "<tr><td colspan='4'>Belum ada data</td></tr>";
            return;
        }

        let arr = Object.values(data).sort((a,b)=> new Date(b.iso)-new Date(a.iso));

        arr.forEach(d=>{
            body.innerHTML += `
                <tr>
                    <td>${d.nama}</td>
                    <td>${d.keterangan}</td>
                    <td>${d.alasan}</td>
                    <td>${d.waktu}</td>
                </tr>
            `;
        });
    });
}
load();
</script>

</body>
</html>
